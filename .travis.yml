sudo: false
language: python
env:
  global:
  - HELM_VERSION="v2.8.2"
  - KUBEVAL_VERSION="0.13.0"
  - CONFTEST_VERSION="0.15.0"
  - secure: CTKnGSVQcAgNqjk4ukYIXOXSVGXS3jQ+Ik8DoxbbappKw+qV+Zz/HJx9bM7lLyXDS1Xnl80Bt5mQht1gM/o1UA1/jthkKEHW123PVeuJh0XwwAifTqGyaBMfDBXRcGNdPX8zwAe3hzVFi08iX352d51FjYdEJigpzt3hpVxy/sRshMIT79fHiZOb2191+ZOLHv99YlNu5Eb+ieHWq07GnkmIbv7Nz4ZRmtfD9haJJZRm39PIMaIAaT9mKtC2jNEf/jVrY0NmVHwm/reqj8ZD1f5rTAN1syOgBwQLYTacRP1XGnw6JFSvJg7ampt7U2o++I3jyaDSevmVdsP7vw5jlEDkE31uGOd/uOnUM86qG/HLpFpWe3ZYiy9AP8dkU1L+ZWKaiaBxPaEpYSINCSMV7WXS37TMPFQoGyZM+mSIk/Hbo0rNDGbtaJ4PA66FSoyvX+Yy8LW+dnX4rqhfOnr3GKXrHFXSD2w08o35ajsoD7otR1cUNlGcdwSWLf4ffS19e0YGi5Xe5la+strd2DFHwXzhliOgkbixS9M6GU7fJn0UNakcsMDk0KpddExBEZTUi4gQC5/FbpXRLdQfqGTC2s9Zp5usCGm37Aaq4CDC/TkeI3NYBE9k94NEVNu7ohKoJCCBZLxN7V9PV8CXdGFY7uGxRlRw0lsM/l/DyPANoJU=
before_script:
- pip install yq jsonschema pyyaml
- wget "https://storage.googleapis.com/kubernetes-helm/helm-${HELM_VERSION}-linux-amd64.tar.gz"
- tar zxf helm-${HELM_VERSION}-linux-amd64.tar.gz
- mkdir bin
- mv linux-amd64/helm ./bin/helm
- wget "https://github.com/instrumenta/kubeval/releases/download/${KUBEVAL_VERSION}/kubeval-linux-amd64.tar.gz"
- tar zxf kubeval-linux-amd64.tar.gz
- mv kubeval ./bin/
- wget "https://github.com/instrumenta/conftest/releases/download/v${CONFTEST_VERSION}/conftest_${CONFTEST_VERSION}_Linux_x86_64.tar.gz"
- tar zxf conftest_${CONFTEST_VERSION}_Linux_x86_64.tar.gz
- mv conftest ./bin/
- export PATH=$PATH:$PWD/bin/
script:
- "./build/update-chart-repo.sh"
after_success:
- "./build/push.sh"
